# RMCThermodynamics

This repository contains the fortran codes to be used in conjunction with RMC for thermodynamic calculations.
More details about the method can be found at https://arxiv.org/abs/2307.11703.
Thermodynamic calculations using reverse Monte Carlo: Simultaneously tuning multiple short-range order parameters for 2D lattice adsorption problem
Suhail Haque, Abhijit Chatterjee

Files contained in this folder
------------------------------
Lattice_Flux.f90 -- Source file
Lattice_Flux_average.f90 -- Source file
newton_v3.f90 -- Source file
Int_file_Cl_PCR.txt -- Input file
lattice_flux_input.txt -- Input file
newton_input.txt -- Input file
README.txt -- This file

Compilation
-----------
To compile the code:
gfortran -o newt_v3.x newton_v3.f90 -llapack
gfortran -o LF Lattice_Flux.f90
gfortran -o LF_avg Lattice_Flux_average.f90

Purpose
-------
newt_v3.x -- This is the main executable. This must be called to begin the thermodynamic calculations using RMC.
Example: ./newt_v3.x 4 newton_input.txt > output_file.txt
LF -- This executable calculates the growth rate of each cluster from the occupation.xyz file created after RMC, after each newton iteration.
      Does not need to be directly called by the user. 
LF_avg -- Multiple RMC calculations with different seeds are run. Each time RMC generates a new configuration, and the growth rates are calculated.This executable                  calculates the average growth rate of the each cluster over all the seeds.
         Does not need to be directly called by the user.

Note
----
RMC code has not been provided. Those interested in the code can contact Prof. Abhijit Chatterjee (abhijit@che.iitb.ac.in).
Alternatively, an RMC code can be provided by the user.


The newt_v3.x executable uses the newton_input.txt file for certain user-defined inputs as follows -
Number of parameters to constrain
Coverage
SRO constraints
Absolute tolerance limit
Maximum iterations
Output flag
Array where 1 indicates the cluster to be contrained and 0 the opposite.
[The clusters are in order 1NN 2NN 3NN 4NN L1 I L2 L3 Q1 Q2 Q3]

For each iteration, (2n+1) RMC configurations are needed for computing the Jacobian, where n is the number of SRO parameters constrained. Each RMC iteration is assigned to a free processor in a cluster. Once the configuration is complete (RMC iteration cycles are over), the occupation.xyz file is read by 'Lattice_Flux.f90'. This code calculates the growth rate or flux with respect to a particular cluster. It also uses 'lattice_flux_input.txt' for inputs. These are the interaction file data - stored as 'Int_file...' and the number of rows and columns of the surface generated by RMC.

RMC calculations are run multiple times parallelly, each with a different seed. All these configurations give a unique 'current_flux_<irank>.txt' file. The code in the 'Lattice_Flux_average.f90' file simply obtains the averages of the individual flux values over all the seeds. The flux values are used to
compute the Jacobian and proceed to the next step.



The output of the 'newton_v3.f90' provides a summary of the flux and the current SRO parameters after each iteration.
